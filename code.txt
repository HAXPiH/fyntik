this was made by another developer
example of some really good code